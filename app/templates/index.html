<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SourceSelect Dashboard v16</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='components/shared/dashboard-core.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='components/projects_tracker/projects_tracker.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='components/clickup_analytics/clickup_analytics.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='components/tools/webflow_importer.css') }}">
  
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <h1>
                     SourceSelect Dashboard
                    <span style="font-size: 1rem; opacity: 0.8;">v16</span>
                </h1>
                <div class="header-subtitle">Last updated: <span id="lastUpdated">8/8/2025 at 12:19:38 AM</span></div>
                <div class="live-indicator">
                    <div class="live-dot"></div>
                    Live Data
                </div>
            </div>
        </div>

        <!-- Date Filters -->
        <div class="date-filters">
            <input type="date" class="date-input" value="2025-08-08" id="dateFilter">
            <button class="filter-btn" data-period="yesterday">Yesterday</button>
            <button class="filter-btn active" data-period="today">Today</button>
            <button class="filter-btn" data-period="week">Last Week</button>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab" data-tab="clickup">ClickUp Analytics</button>
            <button class="nav-tab active" data-tab="projects">Project Tracker</button>
            <button class="nav-tab" data-tab="website">Website Tracker</button>
            <button class="nav-tab" data-tab="tools">Tools</button>
        </div>

        <!-- Tab Content Container -->
        <div class="tab-content-container">
            <!-- ClickUp Analytics Widget -->
            <div class="tab-content" id="clickup-tab">
                <div id="clickup-analytics-widget"></div>
            </div>

            <!-- Project Tracker Widget -->
            <div class="tab-content active" id="projects-tab">
                <div id="projects-tracker-widget"></div>
            </div>

            <!-- Website Tracker Widget -->
            <div class="tab-content" id="website-tab">
                <div id="website-tracker-widget">
                    <div class="projects-section">
                        <div class="section-header">
                            <h3 class="section-title">üåê Website Analytics</h3>
                        </div>
                        <div style="color: #64748b; text-align: center; padding: 40px;">
                            Website tracking data will be displayed here
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tools Tab - Webflow Importer -->

            <form id="webflow-importer-form" >
                  
            <div class="tab-content" id="tools-tab">
              <div class="webflow-importer-widget" id="webflow-importer-widget">
                  <div class="section-header">
                      <h3 class="section-title"> Webflow to WordPress Converter</h3>
                  </div>
                  
                  <div class="converter-cards">
                      <!-- Template Settings Card -->
                      <div class="converter-card">
                          <div class="card-header">
                              <h4 class="card-title">Template Settings</h4>
                          </div>
                          <div class="card-body">
                              <div class="form-group">
                                  <label class="form-label">Template Name</label>
                                  <input type="text" class="form-input" id="theme-name" name="theme_name" required placeholder="e.g. converted-theme">
                              </div>
                              
                              <div class="form-group">
                                  <label class="form-label">Additional Options</label>
                                  <div class="checkbox-options">
                                      <label class="checkbox-option">
                                          <input type="checkbox" name="auto_mailer" checked>
                                          <span class="checkmark"></span>
                                          <span class="option-label">Install Auto Mailer Plugin</span>
                                      </label>
                                      <label class="checkbox-option">
                                          <input type="checkbox" name="page_creator" checked>
                                          <span class="checkmark"></span>
                                          <span class="option-label">Install Auto Page Creator Plugin</span>
                                      </label>
                                      <label class="checkbox-option">
                                          <input type="checkbox" name="backup_nas">
                                          <span class="checkmark"></span>
                                          <span class="option-label">Duplicate Theme to NAS Backup</span>
                                      </label>
                                      <label class="checkbox-option">
                                          <input type="checkbox" name="optimize_images">
                                          <span class="checkmark"></span>
                                          <span class="option-label">Optimize Images During Conversion</span>
                                      </label>
                                  </div>
                              </div>
                          </div>
                      </div>
                      
                      <!-- File Upload Card -->
                      <div class="converter-card">
                          <div class="card-header">
                              <h4 class="card-title">File Uploads</h4>
                          </div>
                          <div class="card-body">
                              <div class="form-group">
                                  <label class="form-label">Webflow ZIP File</label>
                                  <div class="file-upload">
                                      <input type="file" id="webflow-zip" class="file-input" name="webflow_zip" required>
                                      <label for="webflow-zip" class="file-label">
                                          <div>Click to upload Webflow export ZIP</div>
                                          <div class="file-name" id="zip-file-name">No file selected</div>
                                      </label>
                                  </div>
                              </div>
          
                              <div class="form-group">
                                  <label class="form-label">Theme Screenshot</label>
                                  <div class="file-upload">
                                      <input type="file" id="screenshot" class="file-input" name="screenshot" accept=".png,.jpg,.jpeg">
                                      <label for="screenshot" class="file-label">
                                          <div>Click to upload theme screenshot</div>
                                          <div class="file-name" id="screenshot-file-name">No file selected</div>
                                      </label>
                                  </div>
                              </div>
                          </div>
                      </div>
                      
                      <!-- CMS Settings Card -->
                      <div class="converter-card">
                          <div class="card-header">
                              <div class="card-title">CMS Settings</div>
                              <label class="toggle-switch">
                                  <input type="checkbox" id="enable-cms" name="enable_cms">
                                  <span class="toggle-slider-tools"></span>
                              </label>
                          </div>
                          <div id="cms-fields" style="display: none;">
                              <div class="card-body">
                                  <div class="form-group">
                                      <label class="form-label">Webflow API Token</label>
                                      <input type="text" class="form-input" id="api-token" name="api_token" 
                                             placeholder="Get this from Project Settings ‚Üí API Access">
                                  </div>
                                  
                                  <div class="form-group">
                                      <label class="form-label">Webflow Site ID</label>
                                      <input type="text" class="form-input" id="site-id" name="site_id" 
                                             placeholder="Found in Project Settings ‚Üí API Access">
                                  </div>
                                  
                                  <div class="form-group">
                                      <label class="form-label">Custom Collection CSS Selectors</label>
                                      <textarea class="form-input" id="custom-selectors" name="custom_selectors" rows="4"
                                                placeholder="Enter CSS selectors for your collection containers, one per line:
          .my-team-grid
          .portfolio-slider
          .testimonial-carousel
          #reviews-section
          .dynamic-content"></textarea>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  
                  <!-- Action Bar -->
                  <div class="action-bar">
                      <button type="submit" class="convert-button" id="start-import">
                          <span class="button-icon"></span>
                          <span class="button-text">Convert Now</span>
                      </button>
                  </div>
                  
                  <!-- Progress and Status -->
                  <div class="status-container">
                      <div class="progress-container">
                          <div class="progress-bar">
                              <div class="progress-fill" id="import-progress-bar"></div>
                          </div>
                          <div class="progress-status">
                              <span class="percentage">0%</span>
                              <span class="current-action">Ready to start</span>
                          </div>
                      </div>
                      
                      <div class="status-log" id="status-output">
                          
                      </div>
                  </div>
              </div>
          </div>
          
              <!-- <div class="action-bar">
                  <button type="submit" class="convert-button" id="start-import">
                      <span class="button-icon">üîÑ</span>
                      <span class="button-text">Convert Now</span>
                  </button>
              </div> -->
          </form>
     
        </div>
    </div>

    <!-- Core Dashboard Scripts -->
    <script src="{{ url_for('static', filename='components/shared/dashboard-core.js') }}"></script>

    <!-- Component Scripts -->
    <script src="{{ url_for('static', filename='components/clickup_analytics/clickup_analytics.js') }}"></script>
    <script src="{{ url_for('static', filename='components/projects_tracker/projects_tracker.js') }}"></script>
    <script src="{{ url_for('static', filename='components/tools/webflow_importer.js') }}"></script>

    <!-- Main Dashboard Controller -->
    <script>
        class DashboardController {
            constructor() {
                this.activeTab = 'projects';
                this.components = {};
                this.init();
            }

            init() {
                this.setupTabNavigation();
                this.setupDateFilters();
                this.loadComponents();
                this.updateTimestamp();
            }
            

            setupTabNavigation() {
                const tabButtons = document.querySelectorAll('.nav-tab');
                const tabContents = document.querySelectorAll('.tab-content');

                tabButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const targetTab = button.dataset.tab;
                        this.switchTab(targetTab, tabButtons, tabContents);
                    });
                });
            }

            switchTab(targetTab, tabButtons, tabContents) {
                // Update active tab button
                tabButtons.forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-tab="${targetTab}"]`).classList.add('active');
                
                // Update active tab content with animation
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    content.style.opacity = '0';
                });
                
                setTimeout(() => {
                    const targetContent = document.getElementById(`${targetTab}-tab`);
                    targetContent.classList.add('active');
                    targetContent.style.opacity = '1';
                    
                    // Trigger component refresh if needed
                    this.refreshComponent(targetTab);
                }, 150);

                this.activeTab = targetTab;
            }

            setupDateFilters() {
                const filterButtons = document.querySelectorAll('.filter-btn[data-period]');
                const dateInput = document.getElementById('dateFilter');

                filterButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        filterButtons.forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');
                        
                        const period = button.dataset.period;
                        this.updateDateFilter(period);
                    });
                });

                dateInput.addEventListener('change', (e) => {
                    this.updateCustomDate(e.target.value);
                });
            }

            updateDateFilter(period) {
                const now = new Date();
                let targetDate;

                switch(period) {
                    case 'yesterday':
                        targetDate = new Date(now.getTime() - 24 * 60 * 60 * 1000);
                        break;
                    case 'today':
                        targetDate = now;
                        break;
                    case 'week':
                        targetDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                        break;
                }

                if (targetDate) {
                    document.getElementById('dateFilter').value = targetDate.toISOString().split('T')[0];
                    this.refreshActiveComponent();
                }
            }

            updateCustomDate(dateValue) {
                // Remove active class from period buttons
                document.querySelectorAll('.filter-btn[data-period]').forEach(btn => 
                    btn.classList.remove('active')
                );
                
                this.refreshActiveComponent();
            }

            loadComponents() {
                // Initialize components
                if (typeof ClickUpAnalytics !== 'undefined') {
                    this.components.clickup = new ClickUpAnalytics('clickup-analytics-widget');
                }
                
                if (typeof ProjectsTracker !== 'undefined') {
                    this.components.projects = new ProjectsTracker('projects-tracker-widget');
                }
                
                if (typeof WebflowImporter !== 'undefined') {
                    this.components.tools = new WebflowImporter('webflow-importer-widget');
                }
            }

            refreshComponent(componentName) {
                const component = this.components[componentName];
                if (component && typeof component.refresh === 'function') {
                    component.refresh();
                }
            }

            refreshActiveComponent() {
                this.refreshComponent(this.activeTab);
            }

            updateTimestamp() {
                const now = new Date();
                const timestamp = now.toLocaleString('en-US', {
                    month: 'numeric',
                    day: 'numeric',
                    year: 'numeric',
                    hour: 'numeric',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: true
                });
                
                document.getElementById('lastUpdated').textContent = timestamp;
                
                // Update every 30 seconds
                setTimeout(() => this.updateTimestamp(), 30000);
            }
        }

        // Initialize dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboard = new DashboardController();
        });

        document.addEventListener('DOMContentLoaded', function() {
          const toggleSwitch = document.getElementById('enable-cms');
          const cmsFields = document.getElementById('cms-fields');

          if (toggleSwitch && cmsFields) {
            // Initialize state
            cmsFields.style.display = toggleSwitch.checked ? 'block' : 'none';
            
            // Add event listener
            toggleSwitch.addEventListener('change', function() {
              cmsFields.style.display = this.checked ? 'block' : 'none';
            });
          }
        });
    </script>
</body>
</html>